<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>YourSlimBuddy — Connect</title>
  <meta name="description" content="Get your YourSlimBuddy Connect Key to link ChatGPT with your account." />
  <link rel="icon" href="/favicon.ico" />
  <style>
    :root {
      --bg: #0b1220;      /* deep navy */
      --card: #121a2b;   /* slightly lighter */
      --text: #e6eefc;
      --muted: #a9b2c7;
      --brand: #2b6fff;  /* blue CTA */
      --brand-600: #1f57cc;
      --ok: #22c55e;     /* green accent */
      --warn: #f59e0b;
      --border: #263148;
    }
    html, body {
      margin: 0; padding: 0; background: var(--bg); color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
    .wrap {
      min-height: 100dvh; display: grid; place-items: center; padding: 24px;
    }
    .card {
      width: 100%; max-width: 560px; background: var(--card);
      border: 1px solid var(--border); border-radius: 16px; padding: 22px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    h1 { font-size: 1.25rem; margin: 0 0 10px; display: flex; align-items:center; gap:10px; }
    .logo-dot { width: 10px; height:10px; border-radius:999px; background: var(--ok); box-shadow: 0 0 12px var(--ok); }
    .muted { color: var(--muted); font-size: .95rem; }
    .section { margin-top: 16px; }
    .field { display:flex; gap:8px; margin-top:10px; }
    input[type="email"] {
      flex:1; font-size: 1rem; padding: 12px 14px; border-radius: 10px;
      border: 1px solid var(--border); background: #0d1526; color: var(--text);
      outline: none;
    }
    button {
      appearance:none; border: none; border-radius: 10px; padding: 12px 14px;
      background: var(--brand); color: white; font-weight: 600; cursor: pointer;
    }
    button:hover { background: var(--brand-600); }
    .pill {
      display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border-radius: 999px;
      background: #0e1a31; border: 1px solid var(--border); font-size: .9rem;
    }
    .key-box {
      display:flex; align-items:center; justify-content: space-between;
      gap:12px; margin-top:12px; padding:12px; border:1px dashed var(--border);
      border-radius: 10px; background: #0c1427; word-break:break-all;
    }
    .row { display:flex; gap:10px; flex-wrap: wrap; }
    .row > button { flex:1 0 160px; }
    .fine { font-size: .85rem; color: var(--muted); }
    .center { text-align:center; }
    .ok { color: var(--ok); }
    .warn { color: var(--warn); }
    .hr { height:1px; background: var(--border); margin: 16px 0; border:0; }
    footer { margin-top: 16px; text-align:center; font-size: .85rem; color: var(--muted); }
    footer a { color: var(--muted); text-decoration: underline; }
  </style>
  <script type="module" src="/src/main.js"></script>
</head>
<body>
  <div class="wrap">
    <div class="card" id="app">
      <h1><span class="logo-dot" aria-hidden="true"></span> Welcome to YourSlimBuddy Connect</h1>
      <p class="muted">Link ChatGPT to your account with a short, secure Connect Key.</p>

      <!-- STEP 1: Request magic link -->
      <div id="step-email" class="section">
        <div class="pill" id="email-pill" hidden>Signed out</div>
        <p class="fine">Enter your email address and we’ll send you a sign-in link.</p>
        <div class="field">
          <input id="email" type="email" inputmode="email" autocomplete="email" placeholder="you@example.com" />
          <button id="sendLinkBtn">Send magic link</button>
        </div>
        <p id="emailMsg" class="fine"></p>
      </div>

      <!-- STEP 2: After login, issue Connect Key -->
      <div id="step-key" class="section" hidden>
        <div class="pill" id="signedPill">Signed in</div>
        <p class="fine" id="signedDetail"></p>

        <div class="hr"></div>

        <p class="muted">Click **Generate Key** to create your Connect Key. Then copy it and return to YourSlimBuddy GPT.</p>
        <div class="row">
          <button id="issueKeyBtn">Generate key</button>
          <button id="regenKeyBtn" style="display:none;">Regenerate key</button>
        </div>
        <div id="keyWrap" class="key-box" hidden>
          <span id="connectKey">SB-XXXX-XXXX-XXXX</span>
          <div class="row" style="gap:8px;">
            <button id="copyKeyBtn" title="Copy Connect Key">Copy</button>
            <button id="returnBtn" title="Return to YourSlimBuddy">Return</button>
          </div>
        </div>
        <p id="keyMsg" class="fine center"></p>
      </div>

      <footer>
        <a href="/privacy.html">Privacy</a> • <a href="/terms.html">Terms</a>
      </footer>
    </div>
  </div>
</body>
</html>
